(()=>{"use strict";var e={};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var n=e.g.document;if(!t&&n&&(n.currentScript&&(t=n.currentScript.src),!t)){var c=n.getElementsByTagName("script");if(c.length)for(var o=c.length-1;o>-1&&!t;)t=c[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})(),(()=>{function t(e){const t=document.createElement("button");switch(e){case 1:t.className="cell cell_one cell_close";break;case 2:t.className="cell cell_two cell_close";break;case 3:t.className="cell cell_three cell_close";break;case 4:t.className="cell cell_four cell_close";break;case 5:t.className="cell cell_five cell_close";break;case 6:t.className="cell cell_six cell_close";break;case 7:t.className="cell cell_seven cell_close";break;case 8:t.className="cell cell_eight cell_close";break;case 9:t.className="cell cell_mine cell_close";break;default:t.className="cell cell_empty cell_close"}return 0!==e&&9!==e&&(t.textContent=e),t}const n=e.p+"9f776e97fb460a2dada1.mp3",c=e.p+"b83723f037844d797761.mp3",o=e.p+"876aaa7396c15ad49872.mp3",s=e.p+"fb4c7651f758bcc97bd5.mp3",l=e.p+"bb950f1cd7c723ac10b1.mp3";let a=10,r=10,u=0,m=0,i=0,d=a-i,p=0,_=!0,f=!1,S=!1,y=!1,v=[];const g={},b={};function L(e){let t=0;t=e||10;const n=[];let c=0;for(;c<t;){n[c]=[];for(let e=0;e<t;)n[c].push(0),e+=1;c+=1}return n}function E(e){return Math.floor(Math.random()*e)}function h(e,t){console.log("holdPosition",t);const n=e.length,c=function(e,t){const n=e**2,c=[];for(;c.length<a;){const e=E(n);-1===c.indexOf(e)&&e!==t&&c.push(e)}return c}(n,t),o=e;for(let e=0;e<c.length;){const t=c[e]/n,s=Math.floor(t),l=Math.round((t-s)*n);o[s][l]=9,e+=1}return o}function q(e){const t=e,n=t.length;for(let e=0;e<n;){for(let c=0;c<n;){if(9===t[e][c])for(let o=-1;o<=1;){const s=e+o;for(let e=-1;e<=1;){const o=c+e;s>=0&&s<n&&o>=0&&o<n&&9!==t[s][o]&&(t[s][o]+=1),e+=1}o+=1}c+=1}e+=1}return t}function N(){const e=document.querySelector(".mines"),t=document.querySelector(".flags"),n=document.querySelector(".steps"),c=document.querySelector(".times");e.textContent=`${a}`.padStart(3,0),t.textContent=`${i}`.padStart(3,0),c.textContent="000",n.textContent="000"}function w(e){const n=document.querySelector(".playground"),c=e.length;for(let o=0;o<c;){for(let s=0;s<c;)n.append(t(e[o][s])),s+=1;o+=1}}function x(e){const t=e.length;document.querySelector(".wrapper").className=`wrapper outer wrapper_${t}`}function C(e,t){console.log(e);const n=document.querySelector(".modal__wrapper"),c=document.querySelector(".modal__title"),o=document.querySelector(".modal__subtitle");let s="",l="";n.classList.add("modal__wrapper_overlay"),"Save"===e?(s="The game has been saved!",l=t):"Load"===e?(s="The game has been load!",l=t):"Win"===e?(s=`You ${e}! Time: ${m} sec, Steps:  ${p}`,l="You're a real genius!"):(s=`You ${e}! Time: ${m} sec, Steps:  ${p}`,l="Try again!"),c.textContent=s,o.textContent=l}function $(){document.querySelector(".modal__wrapper").classList.remove("modal__wrapper_overlay")}function A(e){const t=e;t.volume=y?0:1,t.play()}function T(e){const t=document.querySelectorAll(".cell_show"),n=document.querySelectorAll(".cell_mine"),c=document.querySelector(".emoji");let o=0;t.forEach((e=>{e.classList.contains("cell_mine")||(o+=1)})),o===e**2-a&&(console.log("You win, your time:",m,"sec"),console.log("You win, counterSteps:",p,"steps"),function(){const e=`Winner Time: ${m} sec, Steps:  ${p}`;10===v.length&&v.pop(),v.unshift(e),function(){const e=document.querySelector(".score");e.innerHTML="",e.textContent="Last 10 games won!";let t=0;v.forEach((n=>{t+=1;const c=document.createElement("li");c.className="results",c.textContent=`${t}. ${n}`,e.append(c)}))}(),console.log(v)}(),C("Win"),A(new Audio(s)),S=!0,c.classList.add("win"),n.forEach((e=>{e.classList.contains("cell_mine")&&e.classList.add("cell_flag")})))}function M(e){const t=e;t.classList.contains("cell_flag")||(t.classList.remove("cell_close"),t.classList.add("cell_show"))}function k(e){const t=e,n=document.querySelector(".mines"),c=document.querySelector(".flags");console.log(d),t.classList.contains("cell_close")&&(A(new Audio(o)),t.classList.contains("cell_flag")?(t.classList.remove("cell_flag"),i-=1,d=a-i,n.textContent=`${d}`.padStart(3,0),c.textContent=`${i}`.padStart(3,0)):(t.classList.add("cell_flag"),i+=1,d=a-i,n.textContent=`${d}`.padStart(3,0),c.textContent=`${i}`.padStart(3,0)))}function z(e){const t=document.querySelectorAll(".cell");return Array.from(t).indexOf(e.target)}function F(e,t,n){let c=[];n&&(c=n),c.push(t);const o=document.querySelectorAll(".cell"),s=e.length,l=t/s,a=Math.floor(l),r=Math.round((l-a)*s);for(let t=-1;t<=1;){const n=a+t;for(let t=-1;t<=1;){const l=r+t;if(n>=0&&n<s&&l>=0&&l<s&&(n!==a||l!==r)){const t=n*s+l,a=o[t];M(a),a.classList.contains("cell_empty")&&-1===c.indexOf(t)&&F(e,t,c)}t+=1}t+=1}}function j(){const e=document.querySelector(".steps");p+=1,e.textContent=`${p}`.padStart(3,0)}function I(){A(new Audio(n))}function H(){const e=document.querySelector(".volume");y?(e.classList.remove("volume_mute"),y=!1):(e.classList.add("volume_mute"),I(),y=!0)}function G(e){let t="";const n=document.querySelector(".playground"),c=(new Date).toLocaleString();"usersInitSave"===e?(t="The player saved the game",g.name=`${t}: ${c}`,g.quantityMines=a,g.sizePlayground=r,g.counterTime=m,g.counterFlag=i,g.currentAmountMines=d,g.counterSteps=p,g.isFirstClick=_,g.isLose=f,g.isWinner=S,g.isMute=y,g.score=v,g.html=n.innerHTML,console.log(g),C("Save",g.name)):"autoSave"===e&&(t="Auto save game",b.name=`${t}: ${c}`,b.quantityMines=a,b.sizePlayground=r,b.counterTime=m,b.counterFlag=i,b.currentAmountMines=d,b.counterSteps=p,b.isFirstClick=_,b.isLose=f,b.isWinner=S,b.isMute=y,b.score=v,b.html=n.innerHTML,console.log("AutoSave",b),C("Save",b.name))}function R(e){const t=document.querySelector(".wrapper"),n=document.querySelector(".playground"),c=document.querySelector(".quantity-mines"),o=document.querySelector(".size"),s=document.querySelector(".volume"),l=document.querySelector(".mines"),u=document.querySelector(".flags"),g=document.querySelector(".steps"),b=document.querySelector(".times");n.innerHTML=e.html,a=e.quantityMines,r=e.sizePlayground,m=e.counterTime,i=e.counterFlag,d=e.currentAmountMines,p=e.counterSteps,_=e.isFirstClick,f=e.isLose,S=e.isWinner,y=e.isMute,v=e.score,t.className=`wrapper outer wrapper_${r}`,c.value=a,o.selectedIndex="10"===r?1:"15"===r?2:3,y?s.classList.add("volume_mute"):(s.classList.remove("volume_mute"),I()),l.textContent=`${d}`.padStart(3,0),u.textContent=`${i}`.padStart(3,0),g.textContent=`${p}`.padStart(3,0),b.textContent=`${m}`.padStart(3,0),C("Load",e.name)}function W(e,t){console.log("_____________________ReSTART_____________________"),document.querySelector(".playground").innerHTML="";const n=q(h(L(e),t));return w(n),x(n),n}function O(e){console.log("REFRESH============================>"),m=0,i=0,p=0,document.querySelector(".emoji").className="emoji happy",W(e),N(),_=!0,S=!1,f=!1,I(),console.log("<============================REFRESH")}function P(){r=u,O(r)}window.onload=function(){!function(){const e=document.querySelector("body"),t=document.createElement("main");t.className="main";const n=document.createElement("section");n.className="wrapper outer";const c=document.createElement("h1");c.className="title inter",c.textContent="Minesweeper";const o=document.createElement("div");o.className="settings inter";const s=document.createElement("div");s.className="controls";const l=document.createElement("div");l.className="buttons-panel";const a=document.createElement("button");a.className="button outer button_new-game",a.textContent="New Game";const r=document.createElement("button");r.className="button outer button_save",r.textContent="Save Game";const u=document.createElement("button");u.className="button outer button_load",u.textContent="Load Game";const m=document.createElement("input");m.className="quantity-mines inter",m.type="number",m.id="quantity-mines",m.setAttribute("min","10"),m.setAttribute("max","99"),m.setAttribute("placeholder","10 Mines...");const i=document.createElement("select");i.className="size inter",i.textContent="Level";const d=document.createElement("option");d.className="def-size",d.setAttribute("value",""),d.setAttribute("disabled","disabled"),d.setAttribute("selected","selected"),d.textContent="Level ( easy )",d.value=10;const p=document.createElement("option");p.className="small-size",p.textContent="easy - 10x10",p.value=10;const _=document.createElement("option");_.className="medium-size",_.textContent="medium - 15x15",_.value=15;const f=document.createElement("option");f.className="hard-size",f.textContent="hard - 25x25",f.value=25;const S=document.createElement("button");S.className="volume outer";const y=document.createElement("div");y.className="status-game inter";const v=document.createElement("div");v.className="status status-mines";const g=document.createElement("label");g.className="label-mines",g.textContent="Mines left";const b=document.createElement("span");b.className="amount inter mines";const L=document.createElement("div");L.className="status status-flags";const E=document.createElement("label");E.className="label-flags",E.textContent="Flags used";const h=document.createElement("span");h.className="amount inter flags";const q=document.createElement("button");q.className="emoji happy";const N=document.createElement("div");N.className="status status-steps";const w=document.createElement("label");w.className="label-steps",w.textContent="Steps";const x=document.createElement("span");x.className="amount inter steps";const C=document.createElement("div");C.className="status status-time";const $=document.createElement("label");$.className="label-time",$.textContent="Time";const A=document.createElement("span");A.className="amount inter times";const T=document.createElement("div");T.className="playground inter";const M=document.createElement("ol");M.className="score inter",M.textContent="Last 10 games won!";const k=document.createElement("h2");k.className="modal__title";const z=document.createElement("h3");z.className="modal__subtitle";const F=document.createElement("button");F.className="button outer button__modal_close",F.textContent="Close";const j=document.createElement("div");j.className="modal";const I=document.createElement("div");I.className="modal__wrapper",v.append(g),v.append(b),L.append(E),L.append(h),N.append(w),N.append(x),C.append($),C.append(A),y.append(v),y.append(L),y.append(q),y.append(N),y.append(C),i.append(d),i.append(p),i.append(_),i.append(f),s.append(m),s.append(i),s.append(S),l.append(a),l.append(r),l.append(u),o.append(s),o.append(l),j.append(k),j.append(z),j.append(F),I.append(j),n.append(c),n.append(o),n.append(y),n.append(T),n.append(M),n.append(I),t.append(n),e.append(t)}(),N();const e=document.querySelector(".size");r=e.value,e.addEventListener("change",(()=>{u=e.value,I()}));const t=document.querySelector(".quantity-mines");t.addEventListener("change",(()=>{I(),t.value<10?(a=10,t.value=a):t.value>99?(a=99,t.value=a):a=t.value}));const n=q(h(L(r)));let o=[];w(n),x(n);const s=document.querySelector(".emoji"),i=document.querySelector(".volume"),d=document.querySelector(".button_new-game"),p=document.querySelector(".button_save"),y=document.querySelector(".button_load"),v=document.querySelector(".button__modal_close"),b=document.querySelector(".playground");b.addEventListener("mouseup",(function(e){const t=e.target,n=t.classList.contains("cell_flag"),s=t.classList.contains("cell_close");if(_){const t=z(e);o=W(r,t),function(e,t,n){const c=document.querySelectorAll(".cell");let o=0;!function(){const e=document.querySelector(".times"),t=setInterval((()=>{f||_||S?clearInterval(t):(m+=1,e.textContent=`${m}`.padStart(3,0))}),1e3)}(),c.forEach((c=>{if(o===n){const o=c;2===e.button?k(o):o.classList.contains("cell_empty")?(j(),I(),M(o),F(t,n)):o.classList.contains("cell")&&(j(),I(),M(o)),T(r)}o+=1}))}(e,o,t)}else if(2===e.button)k(t);else if(!n&&s&&!f){if(j(),t.classList.contains("cell_mine"))t.classList.add("exp"),function(){A(new Audio(c)),A(new Audio(l)),m=0;const e=document.querySelectorAll(".cell_mine"),t=document.querySelectorAll(".cell_flag"),n=document.querySelectorAll(".cell_close"),o=document.querySelector(".emoji");C("Lose"),o.classList.remove("happy"),o.classList.add("sad"),e.forEach((e=>{e.classList.contains("cell_flag")||e.classList.add("cell_show")})),t.forEach((e=>{e.classList.contains("cell_mine")||(e.classList.remove("cell_flag"),e.classList.remove("cell_close"),e.classList.add("cell_flag-wrong"))})),n.forEach((e=>{e.classList.remove("cell_close"),e.classList.add("cell_blocked")})),_=!0}(),f=!0;else if(t.classList.contains("cell_empty")){I(),M(t);const n=z(e);F(o,n)}else t.classList.contains("cell")&&(I(),M(t));T(r)}_=!1})),b.addEventListener("contextmenu",(function(e){e.preventDefault()})),s.addEventListener("click",(()=>O(r))),d.addEventListener("click",P),v.addEventListener("click",$),p.addEventListener("click",(()=>G("usersInitSave"))),y.addEventListener("click",(()=>R(g))),i.addEventListener("click",H)},window.addEventListener("load",(function(){if(localStorage.getItem("autoSavedGameToLs")){const e=JSON.parse(localStorage.getItem("autoSavedGameToLs"));console.log(e.name),R(e)}})),window.addEventListener("beforeunload",(function(){G("autoSave"),localStorage.setItem("autoSavedGameToLs",JSON.stringify(b))}))})()})();